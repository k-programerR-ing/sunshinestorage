# 计算机系统概论笔记

[TOC]

## 第四章 冯∙诺伊曼模型

#### 一. 五个基本部件

```
内存、处理单元、输入、输出、控制单元
```

##### 	1. 内存												

​		**操作包括读操作、写操作**

​		**读内存某个单元（ `LOAD`  操作）**									

​			1）写内存单元地址(A)到 `MAR` 中

​			2）发 “read”信号给内存，内存将MAR中地址对应的数据送到 `MDR` 中

​			3）运算器从`MDR`中读取数据(X)

​		**写内存某个单元（`STORE` 操作）**

​			1）将数据 (X) 写入 `MDR`

​			2）将地址 (A) 写入 `MAR`

​			3）发 “write”信号给内存

##### 	2. 处理单元

​		冯∙诺伊曼模型中唯一的功能单元 `ALU`（算术逻辑单元）

​		LC-3中 `ALU` 可完成 `ADD、OR、NOT`

##### 	3. 输入单元

​		包括输入输出设备：如键盘、鼠标等

##### 	4. 输出单元

​		包括输出设备：如显示器等

##### 	5. 控制单元

​		`PC` 寄存器、`IR`  寄存器



#### 	二. 什么是操作数？

​		书本描述：表示该次操作数的对象是哪些

​		理解：指示操作的对象，一般存放操作数的地址（寄存器和内存地址）

​					可以是寄存器中的数据、内存地址中的数据或者立即数（直接给出的常数值）

​					注意有时候对于操作数的说法会有不同：当我们谈论关于寄存器的属性、功能、操作或者指令时，操作数可能指代寄存器本身。但在执行指令时，操作数通常是指寄存器中的具体内容，即寄存器中存储的数据。



#### 	三. PC、IR 寄存器的理解

​			`PC`寄存器：相当于程序指针，告诉机器现在到哪一条指令了

​			`IR`寄存器：存放具体的机器指令（操作码+操作数=指令）



#### 	四. 指令周期

​	假设 	`PC-> X3001 ADD R1,R1,R2` 

​							`X3002	AND R1,R1,#0`

------

##### 	1. `FETCH`（取指令）

​	<I>. 		先将`PC` (`X3001`) 装入`MAR`，`PC++`

​	<II>.	（系统自动）将`PC`(注意此时PC已经++)对应内存单元内容（`X3002	AND R1,R1,#0`）装入 `MDR`

​	<III>.	控制单元将`MDR`内容装入`IR`	

------

##### 	2. `DECODE`(译码)

​	<I>. 	分析 `IR[15:12]` 4个bit位构成的操作码**对应哪一个指令**（如0001表示`ADD`指令），并输出16根使能线（对应16种不同指令，仅有1根有效，此处为表示`ADD`的那根有效）

​	<II>.	根据操作码，确定对应的操作数。操作码不同，需要的操作数和定义不同。例:指令`LDR`, 最后六位是地址偏移 （offset)指令`ADD`, 最后三位定义了参与运算的第二个源操作数

------

##### 	3. `EVALUATE ADDRESS`（地址计算）

​		需要**间接寻址**的将要偏移的**立即数**加上，即 `PC+偏移`

------

##### 	4.`FETCH OPERANDS`（取操作数）

数据存放地点：寄存器，内存

根据寄存器地址或计算得到的内存地址读取操作数

​	<I>. 	将之前地址计算节拍算出的地址值装入`MAR`

​	<II>.	从`MDR`获取内存的操作数

一旦操作数的实际地址计算完成，处理器会从计算得到的地址处读取操作数的值。如果操作数是存储在寄存器中的数据，处理器会直接读取相应寄存器中的内容。如果操作数是存储在内存中的数据，处理器会通过访问内存，并从计算得到的地址处读取内存中的数据。

需要注意的是，`FETCH OPERANDS`阶段的具体步骤可能会因不同的处理器架构和实现而有所不同。上述步骤给出的是一种常见的执行流程，但实际情况可能因处理器的设计和指令集的实现而有所差异。

------

##### 	5. `Execute`   (执行)

​		基于得到的操作数完成操作码制定的操作

------

##### 	6. `STORE RESULT`（存放结果）

​		把运算结果存放到目标地点(寄存器 or 存储器)

------



#### 五. 改变执行顺序-控制指令

​	但实际程序中的分支指令，循环指令，子程序调用等会改变程序的执行顺序。控制指令：可以改写PC寄存器的内容。

​	无条件跳转 – 改变PC值到目标地址。

​	条件跳转：分支指令等 – 改变PC值取决于跳转条件是否成立



#### 六. 停机操作

​	系统停机的方法：停止时钟（S=1,R=0）。

​	控制单元状态机是在时钟变化控制下进行状态切换，时钟停止，状态机停止工作，终止指令的执行



------

------

------

------



## 第五章. LC-3结构

#### 一. ISA概述

​	**ISA给出了 <u>内存组织方式、寄存器组、指令集（包括操作码、数据类型、寻址模式）</u> 等信息**

​	**内存组织方式**

​		1.寻址空间 – 有多少个存储空间?

​		1.寻址能力 – 每个存储空间有多少位?

​	**寄存器组**

​		有多少?  存储数据长度?  怎么使用?

​	**指令集**

​		1.操作码

​		2.数据类型

​		3.寻址模式

#### 二、操作码

​	<img src="D:\biancheng\my markdown notes\计算机系统概论笔记.assets\PdfImage.png" alt="PdfImage" style="zoom: 50%;" />



​	